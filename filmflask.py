movie_library = {
    'title1': "Transformers: Rise of the Beasts",
    'title2': "Society of the Snow",
    'title3': "Oppenheimer",
    'title4': "John Wick: Chapter 4",
    'title5': "The Exorcist: Believer",
    'title6': "Maestro",
    'title7': "Evil Dead Rise",
    'title8': "Anatomy of a Fall",
    'title9': "Dungeons & Dragons: Honor Among Thieves",
    'title10': "Napoleon",
    'title11': "American Fiction",
    'title12': "The Little Mermaid",
    'title13': "Anyone But You",
    'title14': "The After",
    'title15': "Indiana Jones and the Dial of Destiny",
    'title16': "Knight of Fortune",
    'title17': "Godzilla Minus One",
    'title18': "Pathaan",
    'title19': "Saw X",
    'title20': "Gran Turismo",
    'title21': "The Creator",
    'title22': "Flamin' Hot",
    'title23': "Blue Beetle",
    'title24': "Barbie",
    'title25': "The ABCs of Book Banning",
    'title26': "The Flash",
    'title27': "A Haunting in Venice",
    'title28': "Pachyderme",
    'title29': "Io Capitano",
    'title30': "Perfect Days",
    'title31': "Golda",
    'title32': "Letter to a Pig",
    'title33': "Nǎi Nai & Wài Pó",
    'title34': "The Hunger Games: The Ballad of Songbirds & Snakes",
    'title35': "The Last Repair Shop",
    'title36': "The Nun II",
    'title37': "Five Nights at Freddy's",
    'title38': "Ninety-Five Senses",
    'title39': "The Holdovers",
    'title40': "The Equalizer 3",
    'title41': "The Marvels",
    'title42': "Creed III",
    'title43': "Rustin",
    'title44': "Mission: Impossible - Dead Reckoning Part One",
    'title45': "The Wonderful Story of Henry Sugar",
    'title46': "Sound of Freedom",
    'title47': "To Kill a Tiger",
    'title48': "The Boy and the Heron",
    'title49': "Robot Dreams",
    'title50': "Insidious: The Red Door",
    'title51': "Invincible",
    'title52': "El Conde",
    'title53': "Taylor Swift: The Eras Tour",
    'title54': "Io Capitano",
    'title55': "The Color Purple",
    'title56': "The Eternal Memory",
    'title57': "Ant-Man and the Wasp: Quantumania",
    'title58': "Our Uniform",
    'title59': "Wish",
    'title60': "Guardians of the Galaxy Vol. 3",
    'title61': "Trolls Band Together",
    'title62': "Nimona",
    'title63': "Fast X",
    'title64': "Spider-Man: Across the Spider-Verse",
    'title65': "Detective Conan: Black Iron Submarine",
    'title66': "The Teachers' Lounge",
    'title67': "The Zone of Interest",
    'title68': "The Barber of Little Rock",
    'title69': "The Super Mario Bros. Movie",
    'title70': "Meg 2: The Trench",
    'title71': "Haunted Mansion",
    'title72': "Shazam! Fury of the Gods",
    'title73': "The Wonderful Story of Henry Sugar",
    'title74': "Past Lives",
    'title75': "Bobi Wine: The People's President",
    'title76': "Migration",
    'title77': "Teenage Mutant Ninja Turtles: Mutant Mayhem",
    'title78': "Red, White and Blue",
    'title79': "Napoleon",
    'title80': "Twenty Days in Mariupol",
    'title81': "The Holdovers",
    'title82': "Elemental",
    'title83': "Pachyderme",
    'title84': "Twenty Days in Mariupol",
    'title85': "The ABCs of Book Banning",
    'title86': "Twenty Days in Mariupol",
    'title87': "The ABCs of Book Banning",
    'title88': "Twenty Days in Mariupol",
    'title89': "Twenty Days in Mariupol"
}

oscars = {
    'title1': "20 Days in Mariupol",
    'title2': "American Fiction",
    'title3': "American Symphony",
    'title4': "Anatomy of a Fall",
    'title5': "Barbie",
    'title6': "Bobi Wine: The People's President",
    'title7': "El Conde",
    'title8': "Elemental",
    'title9': "Flamin' Hot",
    'title10': "Four Daughters",
    'title11': "Godzilla Minus One",
    'title12': "Golda",
    'title13': "Guardians of the Galaxy Vol. 3",
    'title14': "Indiana Jones and the Dial of Destiny",
    'title15': "Invincible",
    'title16': "Io Capitano",
    'title17': "Island in Between",
    'title18': "Killers of the Flower Moon",
    'title19': "Knight of Fortune",
    'title20': "Letter to a Pig",
    'title21': "Maestro",
    'title22': "May December",
    'title23': "Mission: Impossible - Dead Reckoning Part One",
    'title24': "Napoleon",
    'title25': "Nimona",
    'title26': "Ninety-Five Senses",
    'title27': "Nyad",
    'title28': "Nǎi Nai & Wài Pó",
    'title29': "Oppenheimer",
    'title30': "Our Uniform",
    'title31': "Pachyderme",
    'title32': "Past Lives",
    'title33': "Perfect Days",
    'title34': "Poor Things",
    'title35': "Red, White and Blue",
    'title36': "Robot Dreams",
    'title37': "Rustin",
    'title38': "Society of the Snow",
    'title39': "Spider-Man: Across the Spider-Verse",
    'title40': "The ABCs of Book Banning",
    'title41': "The After",
    'title42': "The Barber of Little Rock",
    'title43': "The Boy and the Heron",
    'title44': "The Color Purple",
    'title45': "The Creator",
    'title46': "The Eternal Memory",
    'title47': "The Holdovers",
    'title48': "The Last Repair Shop",
    'title49': "The Teachers' Lounge",
    'title50': "The Wonderful Story of Henry Sugar",
    'title51': "The Zone of Interest",
    'title52': "To Kill a Tiger"
}

hgross = {
    'title1': "Barbie",
    'title2': "The Super Mario Bros. Movie",
    'title3': "Oppenheimer",
    'title4': "Guardians of the Galaxy Vol. 3",
    'title5': "Fast X",
    'title6': "Spider-Man: Across the Spider-Verse",
    'title7': "Wonka",
    'title8': "The Little Mermaid",
    'title9': "Mission: Impossible - Dead Reckoning Part One",
    'title10': "Elemental",
    'title11': "Ant-Man and the Wasp: Quantumania",
    'title12': "John Wick: Chapter 4",
    'title13': "Transformers: Rise of the Beasts",
    'title14': "Aquaman and the Lost Kingdom",
    'title15': "Meg 2: The Trench",
    'title16': "Indiana Jones and the Dial of Destiny",
    'title17': "The Hunger Games: The Ballad of Songbirds & Snakes",
    'title18': "Migration",
    'title19': "Five Nights at Freddy's",
    'title20': "Creed III",
    'title21': "The Flash",
    'title22': "The Nun II",
    'title23': "Taylor Swift: The Eras Tour",
    'title24': "Wish",
    'title25': "Sound of Freedom"
}

user_info={}

def signup():
    print("\n\tSign up to a new account")
    username=input("\tEnter new username: ")
    if username in user_info:
        print("\tThis username already exists. ")
    else:
        password=str(input("\tEnter your password: "))
        if len(password) < 8 :
            print("\tPassword must be at least 8 characters.")
        else:
            user_info[username]={'password':password}
            print("\tSign up successful!")
            main()

def login():
    print("\n\tLog-in to your account")
    username=str(input("\tusername: "))
    password=str(input("\tpassword: "))
    if username in user_info and user_info[username]['password']== password:
        print("\tLog-in successful!")
        u_menu(username)
    else:
        print("\tInvalid password/ Account does not exist.")
        return
    
def u_profile(username):
    display_bio = user_info[username].get('bio')
    rated_movies = sum('rating' in movie_data for movie_data in user_info.get(username, {}).values())
    reviewed_movies = sum('review' in movie_data for movie_data in user_info.get(username, {}).values())
    watchlist_count = sum('watchlist' in movie_data for movie_data in user_info.get(username, {}).values())
    
    print(f"\n\t✪ {username}'s Film Flask ✪")
    print(f"\tBio: {display_bio}")
    print("\tHere's your flask summary for year 2023:")
    print(f"\t{rated_movies} movies rated")
    print(f"\t{reviewed_movies} movies reviewed")
    print(f"\t{watchlist_count} movies in watchlist")

    print("\n\t[1] View my Flask")
    print("\t[2] Edit Profile")
    print("\t[3]Back")

    try:
        choice=int(input("\tEnter your choice: "))
        print("_" * 100,)
        print("_" * 100, "\n")

        if choice==1:
            my_flask(username)
        elif choice==2:
            editprofile(username)
        elif choice==3:
            return
        else:
            print("Enter number 1-3 only.")
    except ValueError:
        print("\tInvalid choice, please enter a number")

def my_flask(username):
    while True:
        print("\n\tRated Movies ★★★★★:")
        for movie, data in user_info.get(username,{}).items():
            if 'rating' in data:
                print(f"\t{movie}: {data['rating']} stars")
        print("\n\tReviewed Movies:")
        for movie, data in user_info.get(username,{}).items():
            if 'review' in data:
                print(f"\t{movie}: {data['review']}")
        print("\n\tWatchlist")
        for movie, data in user_info.get(username, {}).items():
            if 'watchlist' in data:
                print(f"\t- {movie}")
        try:
            choice=int(input("\n\t[1] Return: "))
            print("_" * 100,)
            print("_" * 100, "\n")

            if choice==1:
                return
            else:
                print("\tEnter number 1 only.")
        except ValueError:
            print("\tInvalid choice, please enter a number")

def edit_uinfo(username):
    while True:
        print("\n\t---Edit username---")
        username = input("\tEnter username to edit: ")
        
        if username in user_info:
            new_uname = input("\tEnter new username: ")
            new_pass = input("\tEnter new password: ")
            confirm_pass = input("\tConfirm new password: ")
            
            if confirm_pass == new_pass:
                new_pass = user_info[username]['password']
                if new_uname != username:
                    user_info[new_uname] = user_info[username]
                    del user_info[username]
                    username=new_uname
                    u_menu(username)
                    print(f"\tUsername updated successfully! Updated username: {new_uname}")
                print("\tPassword updated successfully!")
                
            else:
                print("\tPasswords do not match.")
        else:
            print("\tUser not found.")

        try:
            choice = int(input("\n[1] Return: "))
            print("_" * 100,)
            print("_" * 100, "\n")

            if choice == 1:
                return
            else:
                print("Enter number 1 only.")
        except ValueError:
            print("\tInvalid choice, please enter a number")

def addbio(username):
    print("\t---Add bio to your profile---")
    user_bio=input("\tBio: ")
    if username not in user_info:
        user_info[username] = {}
    user_info[username]['bio'] = user_bio
    print("\tBio recorded successfully!")
    print("_" * 100,)
    print("_" * 100, "\n")

def editprofile(username):
    while True:
        print("\t---Edit your profile---")
        print("\t1. Update username and password")
        print("\t2. Add Bio")
        print("\t3. Delete account")
        print("\n\t[4] Back: ")

        try:
            choice=int(input("\tEnter your choice: "))
            print("_" * 100,)
            print("_" * 100, "\n")

            if choice==1:
                edit_uinfo(username)
            elif choice==2:
                addbio(username)
            elif choice==3:
                confirmation=input("\tAre you sure you want to delete your account? (Y/N): ")
                try:
                    if confirmation=="Y" or "y":
                        del user_info[username]
                        back=int(input("\tAccount deleted succesfully. Press 1 to go back to the main menu: "))
                        try:
                            if back ==1:
                                main()
                            else:
                                print("\tPlease enter number 1 only.")
                        except ValueError:
                            print("\tInvalid choice, please enter a number")
                    elif confirmation=="N" or "n":
                        return
                    else:
                        print("\tEnter Y/y,N/n only")
                except ValueError:
                    print("\tInvalid choice, please enter a number")
            elif choice==4:
                return
            else:
                print("\tPlease enter only a number from 1-4.")
        except ValueError:
            print("\tInvalid choice, please enter a number")

def movielist(username):
    while True:
        print("\n\t---Sort movies by:---")
        print("\t1. All Movies")
        print("\t2. A-Z")
        print("\t3. Oscar nominated")
        print("\t4. Highest Grossing")
        print("\t5. Return")
        
        try:
            choice=int(input("\n\tEnter your choice: "))
            print("_" * 100,)
            print("_" * 100, "\n")

            if choice==1:
                print("\n\t☆ Best Movies of 2023 ☆")
                for title, movie_name in movie_library.items():
                    print(f'\t-{movie_name}')
                movie_choice = input("\n\tEnter the movie you want to view details (Type the full name exactly as shown). Press 1 to go back: ")
                if movie_choice in movie_library.values():
                    moviechoice_menu(username, movie_choice)
                elif movie_choice==1:
                    return
                else:
                    print("\tMovie not found in the list.")

            elif choice==2:
                print("\n\t☆ A-Z Best Movies of 2023 ☆")
                sortedlist=sorted(movie_library.values())
                for movie_name in sortedlist:
                    print(f'\t-{movie_name}')
                movie_choice = input("\n\tEnter the movie you want to view details (Type the full name exactly as shown). Press 1 to go back: ")
                if movie_choice in movie_library.values():
                    moviechoice_menu(username, movie_choice)
                elif movie_choice==1:
                    return
                else:
                    print("\tMovie not found in the list.")

            elif choice==3:
                print("\n\t☆ Oscar Nominated Movies of 2023 ☆")
                for title, movie_name in oscars.items():
                    print(f'\t-{movie_name}')
                movie_choice = input("\n\tEnter the movie you want to view details (Type the full name exactly as shown). Press 1 to go back: ")
                if movie_choice in oscars.values():
                    moviechoice_menu(username, movie_choice)
                elif movie_choice==1:
                    return
                else:
                    print("\tMovie not found in the list.")

            elif choice==4:
                print("\n\t☆ Top 25 Highest Grossing Films of 2023 ☆")
                for i, (key, movie_name) in enumerate(hgross.items(), 1):
                    print(f'\t{i}. {movie_name}')
                movie_choice = input("\n\tEnter the movie you want to view details (Type the full name exactly as shown). Press 1 to go back: ")
                if movie_choice in hgross.values():
                    moviechoice_menu(username, movie_choice)
                elif movie_choice==1:
                    return
                else:
                    print("\tMovie not found in the list.")

            elif choice==5:
                return
    
            else:
                print("\n\tInvalid number. Please enter a number between 1-5.")
        except ValueError:
            print("\tInvalid choice, please enter a number")

def moviechoice_menu(username, movie_choice):
    while True:
        print("_" * 100,)
        print("_" * 100, "\n")
        print(f'\n\t☆ Movie: {movie_choice} ☆')
        print("\t1. Rate")
        print("\t2. Review")
        print("\t3. Add to watchlist")
        print("\t4. View my flask")
        print("\t5. Back")
        
        try:
            menu_choice = int(input("\tEnter your choice: "))
        
            if menu_choice == 1:
                rating = int(input("\tEnter your rating (1-5 stars) ☆☆☆☆☆: "))
                try:
                    if 1 <= rating <= 5:
                        if username not in user_info:
                            user_info[username] = {}
                        user_info[username].setdefault(movie_choice, {})['rating'] = rating
                        print("\tRating recorded successfully!")
                    else:
                        print("\tInvalid rating. Please enter a rating between 1 and 5.")
                except ValueError:
                    print("\tInvalid choice, please enter a number")
    
            elif menu_choice == 2:
                review = input("\t✪ Write your review: ")
                if username not in user_info:
                    user_info[username] = {}
                user_info[username].setdefault(movie_choice, {})['review'] = review
                print("\tReview recorded successfully!")

            elif menu_choice == 3:
                if username not in user_info:
                    user_info[username] = {}
                user_info[username].setdefault(movie_choice, {})['watchlist'] = True
                print(f"\n{movie_choice} added to watchlist!")
            
            elif menu_choice == 4:
                my_flask(username)

            elif menu_choice == 5:
                return
                
            else:
                print("\tInvalid choice. Please enter a number between 1 and 4.")
        except ValueError:
            print("\tInvalid choice, please enter a number")

def u_menu(username):
    while True:
        print("_" * 100,)
        print("_" * 100, "\n")
        print("\n\t☆☆☆ Movie Dashboard ☆☆☆")
        print("\tHere are the most popular movies of the week:")
        print("\t1. Poor Things\n\t2. Barbie\n\t3. Oppenheimer\n\t4. The Super Mario Bros. Movie\n\t5. Spider-Man: Across the Spider-Verse")
        print("\n\tLoad your flask:")
        print("\t1. View Profile")
        print("\t2. View Movies")
        print("\t3. Log-out")
        
        try:
            choice=int(input("\tEnter your choice: "))
            print("_" * 100,)
            print("_" * 100, "\n")

            if choice==1:
                u_profile(username)
            elif choice==2:
                movielist(username)
            elif choice==3:
                return
            else:
                print("\n\tInvalid choice. Please enter a number between 1-3.")
        except ValueError:
            print("\tInvalid choice, please enter a number")

def main():
    while True:
        print("_" * 100,)
        print("_" * 100, "\n")

        print("""\n
        ███████╗██╗██╗     ███╗   ███╗    ███████╗██╗      █████╗ ███████╗██╗  ██╗
        ██╔════╝██║██║     ████╗ ████║    ██╔════╝██║     ██╔══██╗██╔════╝██║ ██╔╝
        █████╗  ██║██║     ██╔████╔██║    █████╗  ██║     ███████║███████╗█████╔╝ 
        ██╔══╝  ██║██║     ██║╚██╔╝██║    ██╔══╝  ██║     ██╔══██║╚════██║██╔═██╗ 
        ██║     ██║███████╗██║ ╚═╝ ██║    ██║     ███████╗██║  ██║███████║██║  ██╗
        ╚═╝     ╚═╝╚══════╝╚═╝     ╚═╝    ╚═╝     ╚══════╝╚═╝  ╚═╝╚══════╝╚═╝  ╚═╝
                                                                                    """)
        print("\n\t☆☆☆ Rate and review our curated collection of the best movies of 2023. ☆☆☆")
        print("\t1. Signup")
        print("\t2. Login")
        print("\t3. Exit")

        try:
            choice=int(input("\tEnter your choice: "))
            print("_" * 100,)
            print("_" * 100, "\n")

            if choice==1:
                signup()
            elif choice==2:
                login()
            elif choice==3:
                print("\n\tExiting Program...")
                break
            else:
                print("\n\tInvalid choice. Please enter a number between 1-3.")
        except ValueError:
            print("\tInvalid choice, please enter a number")
            
if __name__ == "__main__":
    main()